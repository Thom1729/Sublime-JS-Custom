%YAML 1.2
%TAG ! tag:yaml-macros:yamlmacros.lib.extend,yamlmacros.lib.arguments,yamlmacros.lib.include:
---
!merge
contexts: !merge
  tagged-template: !prepend
    - meta_include_prototype: false
    - include: literal-string-template-custom-comments
    - include: prototype
    - include: literal-string-template-custom-tags

  literal-string-template-custom-tags: !foreach
    in: !argument [tags, {}]
    as: [tag, include]
    value:
      match: !format '({tag})\s*(`)'
      captures:
        1: variable.function.tagged-template.js
        2: punctuation.definition.string.template.begin.js
      set: !include_resource Packages/JSCustom/extensions/custom_template_tags/template.yaml

  literal-string-template-custom-comments: !foreach
    in: !argument [comments, {}]
    as: [tag, include]
    value:
      match: !format '(/\*\s*{tag}\s*\*/)\s*(`)'
      captures:
        1: variable.function.tagged-template.js
        2: punctuation.definition.string.template.begin.js
      set: !include_resource Packages/JSCustom/extensions/custom_template_tags/template.yaml
